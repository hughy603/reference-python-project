[tox]
min_version = 4.0.0
env_list =
    py313
    py312
    py311
    lint
    type
isolated_build = true

[testenv]
description = Run tests with {basepython}
deps =
    pytest>=7.4.4
    pytest-cov>=4.1.0
    pytest-mock>=3.12.0
    hypothesis>=6.98.0
commands =
    pytest {posargs:tests} --cov=src --cov-report=term

[testenv:lint]
description = Run linting checks
deps =
    ruff>=0.3.0
commands =
    ruff check {posargs:.}
    ruff format --check {posargs:.}

[testenv:type]
description = Run type checks
deps =
    pyright>=1.1.350
    typing-extensions>=4.9.0
commands =
    pyright {posargs:src tests}

[testenv:format]
description = Format code with Ruff
deps =
    ruff>=0.3.0
commands =
    ruff format {posargs:.}
    ruff check --fix {posargs:.}

[testenv:docs]
description = Build documentation
deps =
    mkdocs>=1.5.3
    mkdocs-material>=9.4.0
    mkdocstrings[python]>=0.23.0
    pymdown-extensions>=10.3.1
    pygments>=2.16.1
commands =
    mkdocs build

# Enable parallel execution for faster testing
[testenv:.pkg_with_deps]
parallel_show_output = true

# Configuration for using Python 3.11+ features conditionally
[testenv:compat]
description = Check compatibility with Python 3.11+
deps =
    pyupgrade>=3.15.0
commands =
    pyupgrade --py311-plus {posargs:**/*.py}
